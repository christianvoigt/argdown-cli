{"version":3,"sources":["../../../src/commands/JSONCommand.js"],"names":["command","desc","builder","logParserErrors","alias","describe","type","default","spaces","removeMap","removeEmbeddedRelations","handler","argv","config","loadConfig","json","JSONExport","exportMap","inputGlob","inputPath","saveAs","SaveAsFilePlugin","outputDir","logLevel","verbose","watch","process","push","stdout","load","catch","e","console","log"],"mappings":";;;;;;;AAAA;;AAEO,MAAMA,4BAAU,8BAAhB;AACA,MAAMC,sBAAO,oCAAb;AACA,MAAMC,4BAAU;AACrBC,mBAAiB;AACfC,WAAO,GADQ;AAEfC,cAAU,8BAFK;AAGfC,UAAM,SAHS;AAIfC,aAAS;AAJM,GADI;AAOrBC,UAAQ;AACNJ,WAAO,GADD;AAENC,cAAU,6BAFJ;AAGNC,UAAM;AAHA,GAPa;AAYrBG,aAAW;AACTJ,cAAU,iBADD;AAETC,UAAM;AAFG,GAZU;AAgBrBI,2BAAyB;AACvBL,cAAU,6DADa;AAEvBC,UAAM;AAFiB;AAhBJ,CAAhB;AAqBA,MAAMK,4BAAU,UAASC,IAAT,EAAc;AACnC,MAAIC,SAAS,WAAIC,UAAJ,CAAeF,KAAKC,MAApB,CAAb;;AAEAA,SAAOE,IAAP,GAAcF,OAAOE,IAAP,IAAcF,OAAOG,UAArB,IAAkC,EAAhD;;AAEA,MAAGJ,KAAKJ,MAAL,KAAgB,IAAnB,EAAwB;AACtBK,WAAOE,IAAP,CAAYP,MAAZ,GAAqBI,KAAKJ,MAA1B;AACD;AACD,MAAGI,KAAKF,uBAAR,EAAgC;AAC9BG,WAAOE,IAAP,CAAYL,uBAAZ,GAAsC,IAAtC;AACD;AACD,MAAGE,KAAKH,SAAR,EAAkB;AAChBI,WAAOE,IAAP,CAAYE,SAAZ,GAAwB,KAAxB;AACD;;AAED,MAAGL,KAAKM,SAAR,EAAkB;AAChBL,WAAOM,SAAP,GAAmBP,KAAKM,SAAxB;AACD;AACDL,SAAOO,MAAP,GAAgBP,OAAOO,MAAP,IAAgBP,OAAOQ,gBAAvB,IAA0C,EAA1D;AACA,MAAGT,KAAKU,SAAR,EAAkB;AAChBT,WAAOO,MAAP,CAAcE,SAAd,GAA0BV,KAAKU,SAA/B;AACD;;AAEDT,SAAOU,QAAP,GAAkBX,KAAKY,OAAL,GAAe,SAAf,GAA2BX,OAAOU,QAApD;AACAV,SAAOY,KAAP,GAAeb,KAAKa,KAAL,IAAaZ,OAAOY,KAAnC;AACAZ,SAAOa,OAAP,GAAiB,CAAC,cAAD,EAAiB,aAAjB,CAAjB;AACAb,SAAOV,eAAP,GAAyBS,KAAKT,eAAL,IAAwBU,OAAOV,eAAxD;AACA,MAAIU,OAAOV,eAAX,EAA4B;AAC1BU,WAAOa,OAAP,CAAeC,IAAf,CAAoB,mBAApB;AACD;AACDd,SAAOa,OAAP,CAAeC,IAAf,CAAoB,aAApB;AACAd,SAAOa,OAAP,CAAeC,IAAf,CAAoB,aAApB;;AAEA,MAAG,CAACf,KAAKgB,MAAN,IAAgBhB,KAAKU,SAAxB,EAAkC;AAChCT,WAAOa,OAAP,CAAeC,IAAf,CAAoB,cAApB;AACD;AACD,MAAGf,KAAKgB,MAAR,EAAe;AACbf,WAAOa,OAAP,CAAeC,IAAf,CAAoB,aAApB;AACD;;AAED,aAAIE,IAAJ,CAAShB,MAAT,EAAiBiB,KAAjB,CAAuBC,KAAKC,QAAQC,GAAR,CAAYF,CAAZ,CAA5B;AACD,CAzCM","file":"JSONCommand.js","sourcesContent":["import {app} from '../index.js';\n\nexport const command = 'json [inputGlob] [outputDir]';\nexport const desc = 'export Argdown input as JSON files';\nexport const builder = {\n  logParserErrors: {\n    alias: 'e',\n    describe: 'Log parser errors to console',\n    type: 'boolean',\n    default: true\n  },\n  spaces: {\n    alias: 's',\n    describe: 'Spaces used for indentation',\n    type: 'number'\n  },\n  removeMap: {\n    describe: 'Remove map data',\n    type: 'boolean'\n  },\n  removeEmbeddedRelations: {\n    describe: 'Remove relations embedded in statement and relation objects',\n    type: 'boolean'\n  }\n};\nexport const handler = function(argv){\n  let config = app.loadConfig(argv.config);\n  \n  config.json = config.json ||config.JSONExport ||{};\n\n  if(argv.spaces !== null){\n    config.json.spaces = argv.spaces;\n  }\n  if(argv.removeEmbeddedRelations){\n    config.json.removeEmbeddedRelations = true;        \n  }\n  if(argv.removeMap){\n    config.json.exportMap = false;\n  }\n  \n  if(argv.inputGlob){\n    config.inputPath = argv.inputGlob;\n  }\n  config.saveAs = config.saveAs ||config.SaveAsFilePlugin ||{};\n  if(argv.outputDir){\n    config.saveAs.outputDir = argv.outputDir;\n  }\n  \n  config.logLevel = argv.verbose ? \"verbose\" : config.logLevel;\n  config.watch = argv.watch ||config.watch;\n  config.process = ['preprocessor', 'parse-input'];\n  config.logParserErrors = argv.logParserErrors || config.logParserErrors;\n  if (config.logParserErrors) {\n    config.process.push(\"log-parser-errors\");\n  }\n  config.process.push('build-model')\n  config.process.push('export-json');\n\n  if(!argv.stdout || argv.outputDir){\n    config.process.push('save-as-json');\n  }\n  if(argv.stdout){\n    config.process.push('stdout-json');\n  }\n  \n  app.load(config).catch(e => console.log(e));\n} \n"]}