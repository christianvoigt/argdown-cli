{"version":3,"sources":["../../../src/plugins/CopyDefaultCssPlugin.js"],"names":["_","fs","require","path","mkdirp","CopyDefaultCssPlugin","constructor","config","name","defaults","defaultsDeep","outputDir","getSettings","request","copyDefaultCss","prepare","settings","html","saveAs","runAsync","response","logger","rootPath","process","cwd","absoluteOutputDir","resolve","Promise","reject","err","pathToDefaultCssFile","log","COPYFILE_EXCL","constants","copyFile","module","exports"],"mappings":";;AAGA;;IAAYA,C;;;;AAHZ,IAAIC,KAAKC,QAAQ,IAAR,CAAT;AACA,IAAIC,OAAOD,QAAQ,MAAR,CAAX;AACA,IAAIE,SAASF,QAAQ,QAAR,CAAb;;;AAGA,MAAMG,oBAAN,CAA2B;AACvBC,gBAAYC,MAAZ,EAAoB;AAChB,aAAKC,IAAL,GAAY,sBAAZ;AACA,aAAKC,QAAL,GAAgBT,EAAEU,YAAF,CAAe,EAAf,EAAmBH,MAAnB,EAA2B;AACvCI,uBAAW;AAD4B,SAA3B,CAAhB;AAGH;AACDC,gBAAYC,OAAZ,EAAqB;AACjB,YAAI,CAACA,QAAQC,cAAb,EAA6B;AACzBD,oBAAQC,cAAR,GAAyB,EAAzB;AACH;AACD,eAAOD,QAAQC,cAAf;AACH;AACDC,YAAQF,OAAR,EAAiB;AACb,cAAMG,WAAW,KAAKJ,WAAL,CAAiBC,OAAjB,CAAjB;AACAb,UAAEU,YAAF,CAAeM,QAAf,EAAyB,KAAKP,QAA9B;AACA,YAAII,QAAQI,IAAR,IAAgBJ,QAAQI,IAAR,CAAaN,SAAjC,EAA4C;AACxCK,qBAASL,SAAT,GAAqBE,QAAQI,IAAR,CAAaN,SAAlC;AACH,SAFD,MAEO,IAAIE,QAAQK,MAAR,IAAkBL,QAAQK,MAAR,CAAeP,SAArC,EAAgD;AACnDK,qBAASL,SAAT,GAAqBE,QAAQK,MAAR,CAAeP,SAApC;AACH;AACJ;AACD,UAAMQ,QAAN,CAAeN,OAAf,EAAwBO,QAAxB,EAAkCC,MAAlC,EAA0C;AACtC,cAAML,WAAW,KAAKJ,WAAL,CAAiBC,OAAjB,CAAjB;AACA,YAAIS,WAAWT,QAAQS,QAAR,IAAoBC,QAAQC,GAAR,EAAnC;AACA,YAAIC,oBAAoBtB,KAAKuB,OAAL,CAAaJ,QAAb,EAAuBN,SAASL,SAAhC,CAAxB;AACA,cAAM,IAAIgB,OAAJ,CAAY,CAACD,OAAD,EAAUE,MAAV,KAAqB;AACnCxB,mBAAOqB,iBAAP,EAA0B,UAASI,GAAT,EAAc;AACpC,oBAAIA,GAAJ,EAAS;AACLD,2BAAOC,GAAP;AACH;AACDH;AACH,aALD;AAMH,SAPK,CAAN;AAQA,YAAII,uBAAuB5B,QAAQwB,OAAR,CAAgB,4CAAhB,CAA3B;AACAL,eAAOU,GAAP,CAAW,SAAX,EAAsB,4CAA4CN,iBAAlE;AACA,cAAM,EAAEO,aAAF,KAAoB/B,GAAGgC,SAA7B;AACA,cAAM,IAAIN,OAAJ,CAAY,CAACD,OAAD,EAAUE,MAAV,KAAqB;AACnC3B,eAAGiC,QAAH,CAAYJ,oBAAZ,EAAkC3B,KAAKuB,OAAL,CAAaD,iBAAb,EAAgC,aAAhC,CAAlC,EAAkFO,aAAlF,EAAiGH,OAAO;AACpG,oBAAIA,GAAJ,EAAS;AACLD,2BAAOC,GAAP;AACH;AACDH;AACH,aALD;AAMH,SAPK,CAAN;AAQH;AA7CsB;AA+C3BS,OAAOC,OAAP,GAAiB;AACb/B,0BAAsBA;AADT,CAAjB","file":"CopyDefaultCssPlugin.js","sourcesContent":["let fs = require(\"fs\");\nlet path = require(\"path\");\nlet mkdirp = require(\"mkdirp\");\nimport * as _ from \"lodash\";\n\nclass CopyDefaultCssPlugin {\n    constructor(config) {\n        this.name = \"CopyDefaultCssPlugin\";\n        this.defaults = _.defaultsDeep({}, config, {\n            outputDir: \"./html\"\n        });\n    }\n    getSettings(request) {\n        if (!request.copyDefaultCss) {\n            request.copyDefaultCss = {};\n        }\n        return request.copyDefaultCss;\n    }\n    prepare(request) {\n        const settings = this.getSettings(request);\n        _.defaultsDeep(settings, this.defaults);\n        if (request.html && request.html.outputDir) {\n            settings.outputDir = request.html.outputDir;\n        } else if (request.saveAs && request.saveAs.outputDir) {\n            settings.outputDir = request.saveAs.outputDir;\n        }\n    }\n    async runAsync(request, response, logger) {\n        const settings = this.getSettings(request);\n        let rootPath = request.rootPath || process.cwd();\n        let absoluteOutputDir = path.resolve(rootPath, settings.outputDir);\n        await new Promise((resolve, reject) => {\n            mkdirp(absoluteOutputDir, function(err) {\n                if (err) {\n                    reject(err);\n                }\n                resolve();\n            });\n        });\n        let pathToDefaultCssFile = require.resolve(\"argdown-parser/lib/src/plugins/argdown.css\");\n        logger.log(\"verbose\", \"Copying default argdown.css to folder: \" + absoluteOutputDir);\n        const { COPYFILE_EXCL } = fs.constants;\n        await new Promise((resolve, reject) => {\n            fs.copyFile(pathToDefaultCssFile, path.resolve(absoluteOutputDir, \"argdown.css\"), COPYFILE_EXCL, err => {\n                if (err) {\n                    reject(err);\n                }\n                resolve();\n            });\n        });\n    }\n}\nmodule.exports = {\n    CopyDefaultCssPlugin: CopyDefaultCssPlugin\n};\n"]}