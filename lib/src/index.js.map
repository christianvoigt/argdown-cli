{"version":3,"sources":["../../src/index.js"],"names":["program","require","glob","fs","chokidar","mkdirp","app","preprocessor","htmlExport","mapMaker","dotExport","argmlExport","saveAsFilePlugin","addPlugin","version","command","description","option","action","_input","_output","options","input","config","headless","css","title","output","watch","watcher","on","console","log","path","exportFile","er","files","file","err","pathToDefaultCssFile","__dirname","copySync","html","useHtmlLabels","titles","onlyTitlesInHtmlLabels","graphname","parse","process","argv","slice","length","outputHelp","src","dest","existsSync","data","readFileSync","writeFileSync","outputDir","format","processors","sourceFile","dataKey","extension","run","e","stack"],"mappings":"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","file":"index.js","sourcesContent":["\n'use strict';\n/*jshint esversion: 6 */\n/*jslint node: true */\n\n//for some reason this does not work with:\n//'import * as program from 'commander-file';\nlet program = require('commander');\nlet glob = require('glob');\nlet fs = require('fs');\nlet chokidar = require('chokidar');\nlet mkdirp = require('mkdirp');\n\nimport {ArgdownApplication, ArgdownPreprocessor, HtmlExport} from 'argdown-parser';\nimport {MapMaker, DotExport, ArgMLExport} from 'argdown-map-maker';\nimport {SaveAsFilePlugin} from './SaveAsFilePlugin.js';\n\n\nlet app = new ArgdownApplication();\nlet preprocessor = new ArgdownPreprocessor();\nlet htmlExport = new HtmlExport();\nlet mapMaker = new MapMaker();\nlet dotExport = new DotExport();\nlet argmlExport = new ArgMLExport();\nlet saveAsFilePlugin = new SaveAsFilePlugin();\napp.addPlugin(preprocessor, \"preprocessor\");\n\napp.addPlugin(htmlExport, \"export-html\");\n\napp.addPlugin(mapMaker, \"export-dot\");\napp.addPlugin(dotExport, \"export-dot\");\n\napp.addPlugin(mapMaker, \"export-argml\");\napp.addPlugin(argmlExport, \"export-argml\");\n\napp.addPlugin(saveAsFilePlugin, \"save-as-file\");\n\nprogram\n  .version('0.0.0')\n\nprogram\n  .command('html [input] [output]')\n  .description('export Argdown input as HTML files')\n  .option('-hl, --headless', 'Export without Html, Head and Body elements (default:false)')\n  .option('-c, --css <file>','CSS file to include in the HTML head (default:./argdown.css)')\n  .option('-l, --lang <language>', 'Language of HTML document (default:en)')\n  .option('-t, --title <title>', 'Title for HTML document (default: H1 element content)')\n  .option('-w, --watch', 'Continuously watch files for changes and update exported HTML files.')\n  .action(function(_input, _output, options){\n    let input = _input;\n    let config = {};\n\n    if(options.headless)\n      config.headless = true;\n\n    if(options.css)\n      config.css = options.css;\n\n    if(options.title)\n      config.title = options.title;\n\n    htmlExport.config = config;\n\n    if(!input)\n      input = \"./*.argdown\";\n\n    let output = _output;\n    if(!output)\n      output = \"./html\";\n\n    if(options.watch){\n      var watcher = chokidar.watch(input, {});\n      watcher\n      .on('add', path => {\n        console.log(`File ${path} has been added.`);\n        exportFile(path, output, \"html\");\n      })\n      .on('change', path => {\n        console.log(`File ${path} has been changed.`);\n        exportFile(path, output, \"html\");\n      })\n      .on('unlink', path => {\n        console.log(`File ${path} has been removed.`);\n      });\n    }else{\n      glob(input, function (er, files) {\n        if(er){\n          console.log(er);\n          return;\n        }else{\n          console.log(\"glob files: \"+files);\n          for(let file of files){\n            exportFile(file, output, \"html\");\n          }\n        }\n      });\n    }\n    if(!options.css){\n      mkdirp(output, function (err) {\n        if (err){\n          console.log(err);\n        }\n        console.log(\"Copying default argdown.css to folder: \"+output);\n        let pathToDefaultCssFile = __dirname + '/../../node_modules/argdown-parser/lib/src/plugins/argdown.css';\n        copySync(pathToDefaultCssFile, output+\"/argdown.css\");\n      });\n    }\n  });\n\n  program\n    .command('dot [input] [output]')\n    .description('export Argdown graph as .dot files')\n    .option('-h, --html', 'Use HTML node labels (default:false)')\n    .option('-t, --titles','Use only titles in HTML labels (default:false)')\n    .option('-n, --graphname <graphname>', 'Name of the graph (default: Argument Map)')\n    .option('-w, --watch', 'Continuously watch files for changes and update exported dot files.')\n    .action(function(_input, _output, options){\n      let input = _input;\n      let config = {};\n\n      if(options.html)\n        config.useHtmlLabels = true;\n\n      if(options.titles)\n        config.onlyTitlesInHtmlLabels = options.onlyTitlesInHtmlLabels;\n\n      if(options.graphname)\n        config.graphname = options.graphname;\n\n      dotExport.config = config;\n\n      if(!input)\n        input = \"./*.argdown\";\n\n      let output = _output;\n      if(!output)\n        output = \"./dot\";\n\n      if(options.watch){\n        var watcher = chokidar.watch(input, {});\n        watcher\n        .on('add', path => {\n          console.log(`File ${path} has been added.`);\n          exportFile(path, output, \"dot\");\n        })\n        .on('change', path => {\n          console.log(`File ${path} has been changed.`);\n          exportFile(path, output, \"dot\");\n        })\n        .on('unlink', path => {\n          console.log(`File ${path} has been removed.`);\n        });\n      }else{\n        glob(input, function (er, files) {\n          if(er){\n            console.log(er);\n            return;\n          }else{\n            console.log(\"glob files: \"+files);\n            for(let file of files){\n              exportFile(file, output, \"dot\");\n            }\n          }\n        });\n      }\n    });\n\n    program\n      .command('argml [input] [output]')\n      .description('export Argdown graph as .graphml files (with argML extensions)')\n      .option('-w, --watch', 'Continuously watch files for changes and update exported dot files.')\n      .action(function(_input, _output, options){\n        let input = _input;\n        let config = {};\n\n        argmlExport.config = config;\n\n        if(!input)\n          input = \"./*.argdown\";\n\n        let output = _output;\n        if(!output)\n          output = \"./graphml\";\n\n        if(options.watch){\n          var watcher = chokidar.watch(input, {});\n          watcher\n          .on('add', path => {\n            console.log(`File ${path} has been added.`);\n            exportFile(path, output, \"argml\");\n          })\n          .on('change', path => {\n            console.log(`File ${path} has been changed.`);\n            exportFile(path, output, \"argml\");\n          })\n          .on('unlink', path => {\n            console.log(`File ${path} has been removed.`);\n          });\n        }else{\n          glob(input, function (er, files) {\n            if(er){\n              console.log(er);\n              return;\n            }else{\n              console.log(\"glob files: \"+files);\n              for(let file of files){\n                exportFile(file, output, \"argml\");\n              }\n            }\n          });\n        }\n      });\n\nprogram.parse(process.argv);\n\nif (!process.argv.slice(2).length) {\n  program.outputHelp();\n}\n\nfunction copySync(src, dest) {\n  if (!fs.existsSync(src)) {\n    return false;\n  }\n\n  var data = fs.readFileSync(src, 'utf-8');\n  fs.writeFileSync(dest, data);\n}\n\nfunction exportFile(file, outputDir, format){\n  try {\n      let processors;\n      if(format == \"html\"){\n        saveAsFilePlugin.config = {outputDir: outputDir, sourceFile: file, dataKey:\"html\", extension:\".html\"};\n        processors = [\"preprocessor\",\"export-html\",\"save-as-file\"];\n      }else if(format == \"dot\"){\n        saveAsFilePlugin.config = {outputDir: outputDir, sourceFile: file, dataKey:\"dot\", extension:\".dot\"};\n        processors = [\"preprocessor\",\"export-dot\",\"save-as-file\"];\n      }else if(format == \"argml\"){\n        saveAsFilePlugin.config = {outputDir: outputDir, sourceFile: file, dataKey:\"argml\", extension:\".graphml\"};\n        processors = [\"preprocessor\", \"export-argml\", \"save-as-file\"];\n      }else{\n        console.log(\"Format \"+format+\" not supported.\");\n        return;\n      }\n\n      var data = fs.readFileSync(file, 'utf8');\n      app.parse(data, true);\n      app.run(processors);\n  } catch(e) {\n      console.log('Error:', e.stack);\n  }\n}\n"]}